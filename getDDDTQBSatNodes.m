% getDDDTQBSatNodes.m
% This function calculates the values of the third derivative of the
% Trigonometric Quintic B-spline (TQB) basis functions at a given set of nodes.
% The TQB basis functions are defined over a uniform grid.

% Inputs:
% x: A row vector of spatial nodes (grid points) where the TQB basis
%    second derivative functions are to be evaluated.

% Output:
% DDDT: An (N) x (M+4) matrix where N is the number of grid points
%    and M+4 is the number of TQB basis functions.
%    DDDT(i, j) = Value of the third derivative of the j-th TQB basis function
%                at the i-th grid point.

function T = getDDDTQBSatNodes(x)
    % Initialize the matrices for the basis functions and their derivatives
    format long
    d1 = abs(x(2)-x(1)); d2 = abs(x(end)-x(end-1));
    N = length(x);
    T = zeros(N,N+4);
    
    % Update x with ghost points  
    x = [x(1)-6*d1 x(1)-5*d1 x(1)-4*d1 x(1)-3*d1 x(1)-2*d1 x(1)-d1 x x(end)+d2 x(end)+2*d2 x(end)+3*d2 x(end)+4*d2 x(end)+5*d2 x(end)+6*d2]; % x with ghost points

    
    for j = [7 N+6] %7:N+6 for full matrix
        y = x(j);
        
        i = j+2;
        T(j-6,j+4-6) = (3.*cos(x(i-3)./2 - y./2).^3.*sin(x(i-3)./2 - y./2).*sin(x(i-1)./2 - y./2))./(sin(x(i-3)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i)./2).*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2)) - (13.*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).^4)./(8.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2)) - (13.*cos(x(i-3)./2 - y./2).*sin(x(i-3)./2 - y./2).^3.*sin(x(i-1)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i)./2).*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2)) - (13.*cos(x(i-1)./2 - y./2).*sin(x(i-3)./2 - y./2).^4)./(8.*sin(x(i-3)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i)./2).*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2)) - (13.*cos(x(i-2)./2 - y./2).*sin(x(i-3)./2 - y./2).^3.*sin(x(i)./2 - y./2))./(8.*sin(x(i-3)./2 - x(i)./2).*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2)) - (13.*cos(x(i)./2 - y./2).*sin(x(i-3)./2 - y./2).^3.*sin(x(i-2)./2 - y./2))./(8.*sin(x(i-3)./2 - x(i)./2).*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2)) + (3.*cos(x(i-3)./2 - y./2).^3.*sin(x(i-2)./2 - y./2).*sin(x(i)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i)./2).*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2)) - (13.*cos(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).^3.*sin(x(i+2)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2)) - (13.*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).^3)./(8.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2)) + (3.*cos(x(i-2)./2 - y./2).^3.*sin(x(i-3)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2)) - (13.*cos(x(i-2)./2 - y./2).*sin(x(i-2)./2 - y./2).^3.*sin(x(i+3)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2)) + (3.*cos(x(i-2)./2 - y./2).^3.*sin(x(i-2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2)) + (9.*cos(x(i-3)./2 - y./2).^2.*cos(x(i-1)./2 - y./2).*sin(x(i-3)./2 - y./2).^2)./(2.*sin(x(i-3)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i)./2).*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2)) + (3.*cos(x(i-3)./2 - y./2).^2.*cos(x(i+1)./2 - y./2).*sin(x(i-2)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2)) + (3.*cos(x(i-2)./2 - y./2).^2.*cos(x(i+1)./2 - y./2).*sin(x(i-3)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2)) + (9.*cos(x(i-2)./2 - y./2).^2.*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).^2)./(2.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2)) - (13.*cos(x(i+1)./2 - y./2).*sin(x(i-3)./2 - y./2).^2.*sin(x(i-2)./2 - y./2).^2)./(8.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2)) + (9.*cos(x(i-3)./2 - y./2).^2.*cos(x(i-2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i)./2).*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2)) + (9.*cos(x(i-3)./2 - y./2).^2.*cos(x(i)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i)./2).*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2)) + (3.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).^2.*sin(x(i-3)./2 - y./2).*sin(x(i+1)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2)) + (3.*cos(x(i-3)./2 - y./2).^2.*cos(x(i-2)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2)) + (9.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).^2.*sin(x(i-2)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2)) + (9.*cos(x(i-2)./2 - y./2).^2.*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2)) - (39.*cos(x(i-3)./2 - y./2).*sin(x(i-3)./2 - y./2).^2.*sin(x(i-2)./2 - y./2).*sin(x(i)./2 - y./2))./(8.*sin(x(i-3)./2 - x(i)./2).*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2)) - (13.*cos(x(i-3)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).^2.*sin(x(i+1)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2)) - (13.*cos(x(i-2)./2 - y./2).*sin(x(i-3)./2 - y./2).^2.*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2)) - (39.*cos(x(i-2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).^2.*sin(x(i+2)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2)) + (9.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).*cos(x(i)./2 - y./2).*sin(x(i-3)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i)./2).*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2)) + (9.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-2)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2)) + (3.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).*cos(x(i+1)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2))./(sin(x(i-2)./2 - x(i-1)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2));

        i = j+1;
        T(j-6,j+3-6) = (13.*cos(x(i)./2 - y./2).*sin(x(i-3)./2 - y./2).^3.*sin(x(i)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i)./2)) - (3.*cos(x(i-1)./2 - y./2).^3.*sin(x(i+3)./2 - y./2).^2)./(4.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+3)./2)) - (3.*cos(x(i-3)./2 - y./2).^3.*sin(x(i)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i)./2)) + (13.*cos(x(i)./2 - y./2).*sin(x(i-2)./2 - y./2).^3.*sin(x(i+3)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2)) + (13.*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).^3.*sin(x(i)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2)) - (3.*cos(x(i-2)./2 - y./2).^3.*sin(x(i)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2)) + (13.*cos(x(i+3)./2 - y./2).*sin(x(i-1)./2 - y./2).^3.*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+3)./2)) - (9.*cos(x(i-3)./2 - y./2).*cos(x(i)./2 - y./2).^2.*sin(x(i-3)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i)./2)) - (3.*cos(x(i-1)./2 - y./2).*cos(x(i+1)./2 - y./2).^2.*sin(x(i-3)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-3)./2 - y./2).^2.*cos(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i-1)./2 - y./2).^2.*sin(x(i+2)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i+2)./2 - y./2).^2.*sin(x(i-1)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2)) - (9.*cos(x(i-1)./2 - y./2).*cos(x(i+3)./2 - y./2).^2.*sin(x(i-1)./2 - y./2).^2)./(4.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+3)./2)) + (39.*cos(x(i-3)./2 - y./2).*sin(x(i-3)./2 - y./2).^2.*sin(x(i)./2 - y./2).^2)./(8.*sin(x(i-3)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i)./2)) + (13.*cos(x(i-1)./2 - y./2).*sin(x(i-3)./2 - y./2).^2.*sin(x(i+1)./2 - y./2).^2)./(8.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-1)./2 - x(i+1)./2)) + (13.*cos(x(i-3)./2 - y./2).*sin(x(i-1)./2 - y./2).^2.*sin(x(i+2)./2 - y./2).^2)./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2)) + (39.*cos(x(i-1)./2 - y./2).*sin(x(i-1)./2 - y./2).^2.*sin(x(i+3)./2 - y./2).^2)./(8.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+3)./2)) - (9.*cos(x(i-3)./2 - y./2).^2.*cos(x(i)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i+1)./2 - y./2).^2.*sin(x(i-3)./2 - y./2).*sin(x(i-1)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-3)./2 - y./2).^2.*cos(x(i-2)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+1)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2)) - (3.*cos(x(i-3)./2 - y./2).^2.*cos(x(i)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2)) - (3.*cos(x(i-3)./2 - y./2).^2.*cos(x(i+1)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).^2.*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2)) - (3.*cos(x(i-2)./2 - y./2).^2.*cos(x(i)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2)) - (3.*cos(x(i-2)./2 - y./2).^2.*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2)) - (3.*cos(x(i-3)./2 - y./2).^2.*cos(x(i+1)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-1)./2 - y./2).*cos(x(i+2)./2 - y./2).^2.*sin(x(i-3)./2 - y./2).*sin(x(i-1)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2)) - (9.*cos(x(i-2)./2 - y./2).^2.*cos(x(i)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2)) - (9.*cos(x(i-2)./2 - y./2).^2.*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2)) - (3.*cos(x(i-1)./2 - y./2).^2.*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i+2)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2)) - (3.*cos(x(i-2)./2 - y./2).^2.*cos(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2)) - (3.*cos(x(i-2)./2 - y./2).^2.*cos(x(i+1)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2)) - (3.*cos(x(i-2)./2 - y./2).^2.*cos(x(i+3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2)) - (3.*cos(x(i-2)./2 - y./2).*cos(x(i-1)./2 - y./2).^2.*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2)) - (3.*cos(x(i-1)./2 - y./2).^2.*cos(x(i+2)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2)) - (3.*cos(x(i-1)./2 - y./2).^2.*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2)) - (9.*cos(x(i-1)./2 - y./2).^2.*cos(x(i+3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(2.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+3)./2)) + (13.*cos(x(i-3)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-1)./2 - x(i+1)./2)) + (13.*cos(x(i-2)./2 - y./2).*sin(x(i-3)./2 - y./2).^2.*sin(x(i)./2 - y./2).*sin(x(i+1)./2 - y./2))./(8.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2)) + (13.*cos(x(i)./2 - y./2).*sin(x(i-3)./2 - y./2).^2.*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2))./(8.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2)) + (13.*cos(x(i+1)./2 - y./2).*sin(x(i-3)./2 - y./2).^2.*sin(x(i-2)./2 - y./2).*sin(x(i)./2 - y./2))./(8.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2)) + (13.*cos(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).^2.*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2)) + (13.*cos(x(i)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).^2.*sin(x(i+2)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2)) + (13.*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).^2.*sin(x(i)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2)) + (13.*cos(x(i+1)./2 - y./2).*sin(x(i-3)./2 - y./2).^2.*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-1)./2 - x(i+1)./2)) + (39.*cos(x(i-2)./2 - y./2).*sin(x(i-2)./2 - y./2).^2.*sin(x(i)./2 - y./2).*sin(x(i+3)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2)) + (13.*cos(x(i-1)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2)) + (13.*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-1)./2 - y./2).^2.*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2)) + (13.*cos(x(i-1)./2 - y./2).*sin(x(i-2)./2 - y./2).^2.*sin(x(i+1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2)) + (13.*cos(x(i+1)./2 - y./2).*sin(x(i-2)./2 - y./2).^2.*sin(x(i-1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2)) + (13.*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).^2.*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2)) + (13.*cos(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2).^2.*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(8.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2)) + (13.*cos(x(i+2)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2).^2.*sin(x(i+3)./2 - y./2))./(8.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2)) + (13.*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2).^2.*sin(x(i+2)./2 - y./2))./(8.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2)) - (3.*cos(x(i-2)./2 - y./2).*cos(x(i)./2 - y./2).*cos(x(i+1)./2 - y./2).*sin(x(i-3)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-2)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2)) - (9.*cos(x(i-2)./2 - y./2).*cos(x(i)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2)) - (3.*cos(x(i-1)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2)) - (3.*cos(x(i-2)./2 - y./2).*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-1)./2 - y./2).^2)./(4.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).*cos(x(i)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i+1)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).*cos(x(i+1)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i)./2 - y./2).*cos(x(i+1)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).*cos(x(i)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+2)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+1)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i+1)./2 - y./2))./(sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-2)./2 - y./2).*cos(x(i)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).*cos(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).*cos(x(i+1)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+1)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-2)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+1)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-2)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i+1)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-2)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-1)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-1)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) - (3.*cos(x(i-3)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2)) - (3.*cos(x(i-2)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+1)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2)) - (3.*cos(x(i-2)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2)) - (3.*cos(x(i-2)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2)) - (3.*cos(x(i-2)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(2.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2)) - (3.*cos(x(i-2)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(2.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2)) - (3.*cos(x(i-1)./2 - y./2).*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2))./(2.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2)) + (13.*cos(x(i-3)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+1)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2)) + (13.*cos(x(i-2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2)) + (13.*cos(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) + (13.*cos(x(i-2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) + (13.*cos(x(i-1)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) + (13.*cos(x(i+1)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) + (13.*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2))./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2)) + (13.*cos(x(i-2)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2)) + (13.*cos(x(i-1)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-1)./2 - x(i)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2));

        i = j;
        T(j-6,j+2-6) = (3.*cos(x(i+1)./2 - y./2).^3.*sin(x(i-3)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i+3)./2 - y./2).^3.*sin(x(i)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+3)./2)) - (13.*cos(x(i-3)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i+1)./2 - y./2).^3)./(4.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i-3)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2).^3)./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) - (13.*cos(x(i)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i+2)./2 - y./2).^3)./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i+2)./2 - y./2).^3.*sin(x(i-3)./2 - y./2).*sin(x(i)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) - (13.*cos(x(i)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+3)./2 - y./2).^3)./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+3)./2)) + (9.*cos(x(i-3)./2 - y./2).^2.*cos(x(i+1)./2 - y./2).*sin(x(i+1)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-2)./2 - y./2).^2.*cos(x(i+3)./2 - y./2).*sin(x(i+1)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i+1)./2 - y./2).^2.*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i+1)./2 - y./2).*cos(x(i+3)./2 - y./2).^2.*sin(x(i-1)./2 - y./2).^2)./(4.*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2)) + (3.*cos(x(i-1)./2 - y./2).^2.*cos(x(i+1)./2 - y./2).*sin(x(i+3)./2 - y./2).^2)./(4.*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2)) + (9.*cos(x(i)./2 - y./2).^2.*cos(x(i+3)./2 - y./2).*sin(x(i+3)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+3)./2)) - (39.*cos(x(i+1)./2 - y./2).*sin(x(i-3)./2 - y./2).^2.*sin(x(i+1)./2 - y./2).^2)./(8.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).^2.*sin(x(i+1)./2 - y./2).^2)./(8.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i+1)./2 - y./2).*sin(x(i-1)./2 - y./2).^2.*sin(x(i+3)./2 - y./2).^2)./(8.*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2)) - (39.*cos(x(i+3)./2 - y./2).*sin(x(i)./2 - y./2).^2.*sin(x(i+3)./2 - y./2).^2)./(8.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+3)./2)) + (9.*cos(x(i-3)./2 - y./2).*cos(x(i+1)./2 - y./2).^2.*sin(x(i-3)./2 - y./2).*sin(x(i+1)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i+1)./2).*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-3)./2 - y./2).*cos(x(i+1)./2 - y./2).^2.*sin(x(i-2)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-2)./2 - y./2).*cos(x(i+1)./2 - y./2).^2.*sin(x(i-3)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i+1)./2 - y./2).^2.*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-3)./2 - y./2).*cos(x(i+2)./2 - y./2).^2.*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-1)./2 - y./2).*cos(x(i+2)./2 - y./2).^2.*sin(x(i-3)./2 - y./2).*sin(x(i+1)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i+1)./2 - y./2).*cos(x(i+2)./2 - y./2).^2.*sin(x(i-3)./2 - y./2).*sin(x(i-1)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-2)./2 - y./2).*cos(x(i+1)./2 - y./2).^2.*sin(x(i-2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+1)./2)) + (9.*cos(x(i-3)./2 - y./2).*cos(x(i+2)./2 - y./2).^2.*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) + (9.*cos(x(i)./2 - y./2).*cos(x(i+2)./2 - y./2).^2.*sin(x(i-3)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i-2)./2 - y./2).^2.*cos(x(i+1)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-1)./2 - y./2).*cos(x(i+3)./2 - y./2).^2.*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2))./(2.*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2)) + (3.*cos(x(i-2)./2 - y./2).*cos(x(i+2)./2 - y./2).^2.*sin(x(i)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i)./2 - y./2).*cos(x(i+2)./2 - y./2).^2.*sin(x(i-2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i+2)./2 - y./2).^2.*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i-1)./2 - y./2).*cos(x(i+3)./2 - y./2).^2.*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i)./2 - y./2).*cos(x(i+3)./2 - y./2).^2.*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).^2.*sin(x(i-1)./2 - y./2).*sin(x(i)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i-1)./2 - y./2).^2.*cos(x(i+3)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(2.*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2)) + (9.*cos(x(i)./2 - y./2).*cos(x(i+3)./2 - y./2).^2.*sin(x(i)./2 - y./2).*sin(x(i+3)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+3)./2)) - (13.*cos(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2).^2.*sin(x(i+2)./2 - y./2))./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i-2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i+1)./2 - y./2).^2.*sin(x(i+2)./2 - y./2))./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2).^2)./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i-3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2).^2)./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i-1)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2).^2)./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i+1)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2).^2)./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i-2)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2).^2.*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i+1)./2 - y./2).*sin(x(i-2)./2 - y./2).^2.*sin(x(i+1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+1)./2)) - (39.*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2).^2)./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) - (13.*cos(x(i-1)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+3)./2 - y./2).^2)./(4.*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2)) - (13.*cos(x(i-2)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2).^2.*sin(x(i+3)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) - (13.*cos(x(i)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+2)./2 - y./2).^2.*sin(x(i+3)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) - (13.*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2).^2)./(8.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) - (13.*cos(x(i-1)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2).^2)./(8.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2)) - (13.*cos(x(i)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2).^2)./(8.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2)) - (13.*cos(x(i+2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+3)./2 - y./2).^2)./(8.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2)) - (13.*cos(x(i+3)./2 - y./2).*sin(x(i-1)./2 - y./2).^2.*sin(x(i+1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2)) + (3.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i+1)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-3)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (9.*cos(x(i-3)./2 - y./2).*cos(x(i)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i+2)./2 - y./2).^2)./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i-2)./2 - y./2).*cos(x(i)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i+2)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i-1)./2 - y./2).*cos(x(i)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i-3)./2 - y./2).*cos(x(i-2)./2 - y./2).*cos(x(i+1)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-3)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-2)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i+1)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-3)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-3)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-2)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2))./(sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-1)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i+2)./2 - y./2))./(2.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-2)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-2)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-2)./2 - y./2).*cos(x(i-1)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-2)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-2)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-2)./2 - y./2).*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-1)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-1)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-1)./2 - y./2).*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i+1)./2 - y./2).*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) + (3.*cos(x(i-2)./2 - y./2).*cos(x(i)./2 - y./2).*cos(x(i+2)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i-2)./2 - y./2).*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i-1)./2 - y./2).*cos(x(i+1)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2)) + (3.*cos(x(i)./2 - y./2).*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+2)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i-1)./2 - y./2).*cos(x(i)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i-1)./2 - y./2).*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+3)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2)) + (3.*cos(x(i)./2 - y./2).*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2)) - (13.*cos(x(i+1)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i-1)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i+1)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i+2)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+1)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2)) - (13.*cos(x(i+2)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i)./2 - x(i+2)./2)) - (13.*cos(x(i+3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+1)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2));

        i = j-1;
        T(j-6,j+1-6) = (13.*cos(x(i-3)./2 - y./2).*sin(x(i+2)./2 - y./2).^4)./(8.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) + (13.*cos(x(i+1)./2 - y./2).*sin(x(i+3)./2 - y./2).^4)./(8.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+3)./2).*sin(x(i+1)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+3)./2)) + (13.*cos(x(i+2)./2 - y./2).*sin(x(i-3)./2 - y./2).*sin(x(i+2)./2 - y./2).^3)./(2.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (3.*cos(x(i+2)./2 - y./2).^3.*sin(x(i-3)./2 - y./2).*sin(x(i+2)./2 - y./2))./(sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) + (13.*cos(x(i-2)./2 - y./2).*sin(x(i+2)./2 - y./2).^3.*sin(x(i+3)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) + (13.*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+2)./2 - y./2).^3)./(8.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (3.*cos(x(i+2)./2 - y./2).^3.*sin(x(i-2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) + (13.*cos(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2).^3)./(8.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+3)./2).*sin(x(i+1)./2 - x(i+2)./2)) + (13.*cos(x(i+2)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+3)./2 - y./2).^3)./(8.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+3)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (3.*cos(x(i+3)./2 - y./2).^3.*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+3)./2).*sin(x(i+1)./2 - x(i+2)./2)) + (13.*cos(x(i+3)./2 - y./2).*sin(x(i+1)./2 - y./2).*sin(x(i+3)./2 - y./2).^3)./(2.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+3)./2).*sin(x(i+1)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+3)./2)) - (3.*cos(x(i+3)./2 - y./2).^3.*sin(x(i+1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+3)./2).*sin(x(i+1)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+3)./2)) - (9.*cos(x(i-3)./2 - y./2).*cos(x(i+2)./2 - y./2).^2.*sin(x(i+2)./2 - y./2).^2)./(2.*sin(x(i-3)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (3.*cos(x(i-1)./2 - y./2).*cos(x(i+2)./2 - y./2).^2.*sin(x(i+3)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (3.*cos(x(i-1)./2 - y./2).*cos(x(i+3)./2 - y./2).^2.*sin(x(i+2)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (9.*cos(x(i+1)./2 - y./2).*cos(x(i+3)./2 - y./2).^2.*sin(x(i+3)./2 - y./2).^2)./(2.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+3)./2).*sin(x(i+1)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+3)./2)) + (13.*cos(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2).^2.*sin(x(i+3)./2 - y./2).^2)./(8.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (9.*cos(x(i-2)./2 - y./2).*cos(x(i+2)./2 - y./2).^2.*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (9.*cos(x(i+2)./2 - y./2).^2.*cos(x(i+3)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+2)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (3.*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).^2.*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (3.*cos(x(i+2)./2 - y./2).^2.*cos(x(i+3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+3)./2 - y./2))./(2.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (9.*cos(x(i)./2 - y./2).*cos(x(i+3)./2 - y./2).^2.*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+3)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (9.*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).^2.*sin(x(i)./2 - y./2).*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+3)./2).*sin(x(i+1)./2 - x(i+2)./2)) + (39.*cos(x(i+2)./2 - y./2).*sin(x(i-2)./2 - y./2).*sin(x(i+2)./2 - y./2).^2.*sin(x(i+3)./2 - y./2))./(8.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) + (13.*cos(x(i+2)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) + (13.*cos(x(i+3)./2 - y./2).*sin(x(i-1)./2 - y./2).*sin(x(i+2)./2 - y./2).^2.*sin(x(i+3)./2 - y./2))./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) + (39.*cos(x(i+3)./2 - y./2).*sin(x(i)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2).^2)./(8.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+3)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (9.*cos(x(i-2)./2 - y./2).*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i+2)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i+2)./2).*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (9.*cos(x(i)./2 - y./2).*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i+3)./2 - y./2).^2)./(4.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i)./2 - x(i+3)./2).*sin(x(i+1)./2 - x(i+2)./2)) - (3.*cos(x(i-1)./2 - y./2).*cos(x(i+2)./2 - y./2).*cos(x(i+3)./2 - y./2).*sin(x(i+2)./2 - y./2).*sin(x(i+3)./2 - y./2))./(sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+2)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+2)./2).*sin(x(i+1)./2 - x(i+2)./2));
        
        i = j-2;
        T(j-6,j-6) = (15.*cos(x(i+3)./2 - y./2).^3.*sin(x(i+3)./2 - y./2).^2)./(2.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+3)./2).*sin(x(i+1)./2 - x(i+3)./2).*sin(x(i+2)./2 - x(i+3)./2)) - (65.*cos(x(i+3)./2 - y./2).*sin(x(i+3)./2 - y./2).^4)./(8.*sin(x(i-2)./2 - x(i+3)./2).*sin(x(i-1)./2 - x(i+3)./2).*sin(x(i)./2 - x(i+3)./2).*sin(x(i+1)./2 - x(i+3)./2).*sin(x(i+2)./2 - x(i+3)./2));
    end

end